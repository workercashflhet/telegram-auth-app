<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wheel of Fortune</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —à—Ä–∏—Ñ—Ç Lost Star –∏ –¥—Ä—É–≥–∏–µ —à—Ä–∏—Ñ—Ç—ã -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Lost Star —Å —Å–∞–π—Ç–∞ 1001fonts.com (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ Google Fonts) -->
    <link href="https://fonts.googleapis.com/css2?family=Sacramento&family=Bangers&family=Russo+One&family=Orbitron:wght@400;500;600;700;800&display=swap" rel="stylesheet">
     <style>
        /* –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        .stacks-title {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 3.5rem;
            background: linear-gradient(45deg, #4ecdc4, #ff6b6b, #45b7d1, #96ceb4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(78, 205, 196, 0.3);
            letter-spacing: 2px;
            text-transform: uppercase;
            margin: 10px 0 30px 0;
            position: relative;
            display: inline-block;
        }
        
        .stacks-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 10%;
            width: 80%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #4ecdc4, #ff6b6b, transparent);
            border-radius: 2px;
        }
        
        .stacks-subtitle {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.2rem;
            color: #888;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 40px;
            font-weight: 500;
        }
        
        @media (max-width: 768px) {
            .stacks-title {
                font-size: 2.8rem;
            }
            
            .stacks-subtitle {
                font-size: 1rem;
                letter-spacing: 2px;
            }
        }
        
        @media (max-width: 480px) {
            .stacks-title {
                font-size: 2.2rem;
            }
            
            .stacks-subtitle {
                font-size: 0.9rem;
                letter-spacing: 1px;
            }
        }
    </style>
</head>
<body>
    <div id="starfield" class="starfield"></div>
    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É -->
    <div id="compactProfile" class="compact-profile" role="region" aria-label="–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
        <div id="compactAvatar" class="compact-avatar" aria-hidden="true">
            <div id="compactInitials" class="compact-initials">T</div>
            <img id="compactPhoto" class="compact-photo" style="display: none;" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è">
        </div>
        <div id="compactInfo" class="compact-info">
            <div id="compactName" class="compact-name" aria-live="polite">–ì–æ—Å—Ç—å</div>
            <div id="compactStatus" class="compact-status" aria-live="polite">–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</div>
        </div>
        <button id="compactToggle" class="compact-toggle" 
                title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Ñ–∏–ª—å"
                aria-label="–°–≤–µ—Ä–Ω—É—Ç—å –∏–ª–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
                aria-expanded="true">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>

    <!-- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è -->
    <div id="winnerPush" class="winner-push" role="alert" aria-live="assertive" aria-label="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ">
        <div class="winner-push-content">
            <div class="winner-push-header">
                <span class="winner-push-icon" aria-hidden="true">üèÜ</span>
                <span class="winner-push-title">–ü–û–ë–ï–î–ò–¢–ï–õ–¨ –†–ê–£–ù–î–ê!</span>
                <button class="winner-push-close" 
                        onclick="window.fortuneWheel?.hideWinnerPush()"
                        title="–ó–∞–∫—Ä—ã—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"
                        aria-label="–ó–∞–∫—Ä—ã—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="winner-push-body">
                <div class="winner-push-avatar" aria-hidden="true">
                    <img id="winnerPushPhoto" class="winner-push-photo" style="display: none;" alt="–§–æ—Ç–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è">
                    <div id="winnerPushInitials" class="winner-push-initials">W</div>
                </div>
                <div class="winner-push-details">
                    <div id="winnerPushName" class="winner-push-name" aria-live="polite">–ò–º—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</div>
                    <div class="winner-push-stats">
                        <span class="winner-push-trophy" aria-label="–ü–æ–±–µ–¥–∏—Ç–µ–ª—å —ç—Ç–æ–≥–æ —Ä–∞—É–Ω–¥–∞">
                            <i class="fas fa-trophy" aria-hidden="true"></i> –ü–æ–±–µ–¥–∏—Ç–µ–ª—å —ç—Ç–æ–≥–æ —Ä–∞—É–Ω–¥–∞
                        </span>
                    </div>
                    <div class="winner-push-timer">
                        <i class="fas fa-clock" aria-hidden="true"></i>
                        –°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑: <span id="winnerPushTimer" aria-live="polite">8</span> —Å–µ–∫
                    </div>
                </div>
            </div>
            <div class="winner-push-footer">
                <button class="winner-push-button" 
                        onclick="window.fortuneWheel?.joinGame()"
                        title="–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞—É–Ω–¥—É"
                        aria-label="–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞—É–Ω–¥—É –∏–≥—Ä—ã">
                    <i class="fas fa-plus" aria-hidden="true"></i> –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞—É–Ω–¥–µ
                </button>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="app-container">
        <!-- –í–∫–ª–∞–¥–∫–∞ –ì–ª–∞–≤–Ω–∞—è -->
        <div id="homeTab" class="tab-content active">
            <!-- –ö–†–ê–°–ò–í–´–ô –ó–ê–ì–û–õ–û–í–û–ö STACKS –°–û –®–†–ò–§–¢–û–ú LOST STAR -->
            <div class="stacks-header">
                
                <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ STACKS (–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç) -->
                <h1 class="stacks-logo white" id="stacksTitle">STACKS</h1>
            
            </div>
            
            

            <!-- –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã -->
            <div class="game-timer-container">
                <div id="gameTimer" class="game-timer">0</div>
                <div id="timerLabel" class="timer-label">–£–ß–ê–°–¢–ù–ò–ö–û–í</div>
            </div>
            
            <!-- –ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã -->
            <div class="wheel-container gradient-transparent">
                <div class="wheel-wrapper">
                    <div id="fortuneWheel" class="wheel">
                        <div id="wheelParticipants"></div>
                    </div>
                    <div class="wheel-center"></div>
                    <div class="wheel-pointer">‚ñº</div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
                <div class="game-controls">
                    <button id="joinButton" class="game-button"
                            title="–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∏–≥—Ä–µ"
                            aria-label="–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Ç–µ–∫—É—â–µ–π –∏–≥—Ä–µ –Ω–∞ –∫–æ–ª–µ—Å–µ —Ñ–æ—Ä—Ç—É–Ω—ã">
                        <span class="icon" aria-hidden="true">‚ûï</span>
                        –£–ß–ê–°–¢–í–û–í–ê–¢–¨
                    </button>
                    <div style="color: #666; font-size: 0.9rem; text-align: center; margin-top: 10px;">
                        –ò–≥—Ä–∞ –Ω–∞—á–Ω–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è 2-—Ö –∏–≥—Ä–æ–∫–æ–≤
                    </div>
                </div>
            </div>

            
                      
            <!-- –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ -->
            <div class="participants-list">
                <h3 class="participants-title">
                    <span class="icon">üë•</span>
                    –£–ß–ê–°–¢–ù–ò–ö–ò
                </h3>
                <div id="participantsList"></div>
            </div>

            <!-- –°—Ç–∞—Ç—É—Å -->
            <div id="statusMessage" class="status-message" style="visibility: hidden; height: 0; overflow: hidden; padding: 0; margin: 0;">
                <span id="statusText"></span>
            </div>
            
            <!-- –ë–ª–æ–∫ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è -->
            <div id="winnerSection" class="winner-section">
                <h3 class="winner-title">üéâ –ü–û–ë–ï–î–ò–¢–ï–õ–¨ –†–ê–£–ù–î–ê! üéâ</h3>
                <div id="winnerAvatar" class="winner-avatar">
                    <div class="initials">W</div>
                </div>
                <div id="winnerName" class="winner-name">–ò–º—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</div>
                <div style="margin-top: 15px; color: #000; font-size: 1rem;">
                    <div id="nextRoundInfo">–°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑: <span id="nextRoundTimer">8</span> —Å–µ–∫</div>
                    <div id="newRoundInfo" style="display: none; margin-top: 10px; font-weight: bold;">
                        üÜï –ù–û–í–´–ô –†–ê–£–ù–î! –ù–∞–∂–º–∏—Ç–µ "–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å"
                    </div>
                </div>
            </div>

            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ -->
            <div id="authIndicator" style="visibility: hidden; text-align: center; margin: 10px 0; padding: 10px; background: rgba(0,255,0,0.1); border-radius: 10px;">
                <span style="color: #4ecdc4;">‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∫–∞–∫: <span id="currentUserName">–ò–º—è</span></span>
            </div>
        </div> <!-- –ó–∞–∫—Ä—ã–≤–∞–µ–º homeTab -->
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="profileTab" class="tab-content">
            <h1 class="page-title">üë§ –ü–†–û–§–ò–õ–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø</h1>
            
            <div class="profile-tab">
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ -->
                <div id="dataBadge" class="status-badge" style="display: none;">
                    <span id="badgeText"></span>
                </div>
                
                <!-- –ê–≤–∞—Ç–∞—Ä –∏ –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                <div class="profile-header">
                    <div id="profileAvatar" class="profile-avatar">
                        <img id="profilePhoto" class="profile-photo" style="display: none;" 
                            alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        <div id="profileInitials" class="profile-initials" 
                            style="display: flex; align-items: center; justify-content: center; 
                                    font-size: 3rem; font-weight: bold; color: #fff;">
                            ?
                        </div>
                    </div>
                    <h2 id="userFullName" class="profile-name">–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</h2>
                    <div id="userUsername" class="profile-username">–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram</div>
                    
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                    <div class="user-stats" style="margin-top: 20px; display: none;" id="userStats">
                        <div style="display: flex; justify-content: center; gap: 20px;">
                            <div class="stat-item">
                                <div class="stat-value" id="statGamesPlayed">0</div>
                                <div class="stat-label">–ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="statGamesWon">0</div>
                                <div class="stat-label">–ü–æ–±–µ–¥</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="statWinRate">0%</div>
                                <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ñ–∏–ª–µ -->
                <div id="profileInfo" class="profile-info-grid">
                    <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Telegram -->
                <div class="telegram-info-section" style="margin-top: 30px; display: none;" id="telegramInfo">
                    <h3 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fab fa-telegram"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è Telegram
                    </h3>
                    <div class="telegram-info-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="profile-actions" style="text-align: center; margin-top: 40px;">
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button id="refreshProfileButton" class="game-button" 
                                style="background: #4ecdc4;"
                                title="–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è"
                                aria-label="–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è">
                            <span class="icon" aria-hidden="true">üîÑ</span>
                            –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                        <button id="logoutButton" class="game-button" 
                                style="background: #ff6b6b;"
                                title="–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞"
                                aria-label="–í—ã–π—Ç–∏ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                            <span class="icon" aria-hidden="true">üö™</span>
                            –í—ã–π—Ç–∏
                        </button>
                    </div>
                </div>
            </div>
        </div> <!-- –ó–∞–∫—Ä—ã–≤–∞–µ–º profileTab -->
    </div> <!-- –ó–∞–∫—Ä—ã–≤–∞–µ–º app-container -->
    
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="app-nav" role="navigation" aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
        <button id="navHome" class="nav-button active" data-tab="homeTab"
                title="–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é"
                role="tab"
                aria-selected="true"
                aria-controls="homeTab">
            <span class="icon" aria-hidden="true">üé∞</span>
            –ì–ª–∞–≤–Ω–∞—è
        </button>
        <button id="navProfile" class="nav-button" data-tab="profileTab"
                title="–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å"
                role="tab"
                aria-selected="false"
                aria-controls="profileTab">
            <span class="icon" aria-hidden="true">üë§</span>
            –ü—Ä–æ—Ñ–∏–ª—å
        </button>
    </nav>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="/wheel.js"></script>
    <script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let tg = null;
    let currentUser = null;
    let isTelegramApp = false;
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
    const statusMessage = document.getElementById('statusMessage');
    const statusText = document.getElementById('statusText');
    const dataBadge = document.getElementById('dataBadge');
    const badgeText = document.getElementById('badgeText');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
    function initTelegram() {
        try {
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                tg = Telegram.WebApp;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram WebApp
                tg.ready();
                tg.expand();
                tg.setHeaderColor('#000000');
                tg.setBackgroundColor('#000000');
                tg.enableClosingConfirmation();
                
                isTelegramApp = true;
                
                console.log('‚úÖ Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                console.log('üì± –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:', tg.platform);
                console.log('üë§ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', tg.initData ? '–ï—Å—Ç—å' : '–ù–µ—Ç');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
                if (tg.initData && tg.initData.length > 0) {
                    console.log('üì± –ù–∞–π–¥–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ Telegram, –ø—ã—Ç–∞–µ–º—Å—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è...');
                    autoLogin();
                } else {
                    console.log('‚ö†Ô∏è –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö Telegram');
                    showStatus('–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏', 'info');
                }
                
                return true;
            } else {
                console.log('‚ö†Ô∏è Telegram WebApp –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                return false;
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram:', error);
            return false;
        }
    }

    console.log('üîß –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏...');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    document.addEventListener('DOMContentLoaded', () => {
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM:');
        console.log('  joinButton:', document.getElementById('joinButton') ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω');
        console.log('  fortuneWheel:', document.getElementById('fortuneWheel') ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω');
        console.log('  navHome:', document.getElementById('navHome') ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—ä–µ–∫—Ç –∫–æ–ª–µ—Å–∞
        setTimeout(() => {
            console.log('üé° –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ä–µ–∫—Ç–∞ –∫–æ–ª–µ—Å–∞:', window.fortuneWheel ? '‚úÖ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω' : '‚ùå –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            if (window.fortuneWheel) {
                console.log('  –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:', window.fortuneWheel.participants.length);
                console.log('  –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', window.currentUser ? window.currentUser.first_name : '–Ω–µ—Ç');
            }
        }, 1000);
    });
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    function updateAuthIndicator() {
        const authIndicator = document.getElementById('authIndicator');
        const currentUserName = document.getElementById('currentUserName');
        
        if (window.currentUser) {
            authIndicator.style.display = 'block';
            currentUserName.textContent = window.currentUser.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            console.log(`üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: ${window.currentUser.first_name}`);
        } else {
            authIndicator.style.display = 'none';
            console.log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
        }
    }
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥
    // –í index.html –¥–æ–±–∞–≤—å—Ç–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é autoLogin():
    async function autoLogin() {
        try {
            showStatus('‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...', 'info');
            
            const response = await fetch('/api/auth', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ initData: tg.initData })
            });
            
            const data = await response.json();
            
            if (data.success && data.user) {
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
                window.currentUser = data.user;
                currentUser = data.user;
                
                console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:', window.currentUser.first_name);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                updateAuthIndicator();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–µ—Å–æ –µ—Å–ª–∏ –æ–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
                if (window.fortuneWheel) {
                    window.fortuneWheel.updateButtons();
                    // –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏
                    setTimeout(() => {
                        window.fortuneWheel.loadGameState();
                    }, 500);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                updateProfileTab();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–π–¥–∂
                if (dataBadge) {
                    dataBadge.className = 'status-badge badge-real';
                    badgeText.textContent = '–†–ï–ê–õ–¨–ù–´–ô –†–ï–ñ–ò–ú';
                }
                
                showStatus(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${data.user.first_name}!`, 'success');
                
                // –¢—Ä–∏–≥–≥–µ—Ä–∏–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                window.dispatchEvent(new CustomEvent('userChanged'));
                
                console.log(`‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞: ${data.user.first_name} (ID: ${data.user.id})`);
            } else {
                showStatus('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ' + (data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', data.error);
            }
        } catch (error) {
            console.error('Auto login error:', error);
            showStatus('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
        }
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
    function showStatus(message, type = 'info') {
        if (!statusText || !statusMessage) return;
        
        statusText.textContent = message;
        statusMessage.className = `status-message status-${type} visible`;
        
        console.log(`üì¢ –°—Ç–∞—Ç—É—Å (${type}): ${message}`);
        
        // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ
        if (type !== 'error') {
            setTimeout(() => {
                statusMessage.classList.remove('visible');
            }, 3000);
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        window.showStatus = showStatus;
    }
    
    // –û–±–Ω–æ–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É –ø—Ä–æ—Ñ–∏–ª—è
    // –û–±–Ω–æ–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É –ø—Ä–æ—Ñ–∏–ª—è
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async function updateProfileTab() {
        console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è...');
        
        const user = window.currentUser;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
        updateCompactProfile();
        
        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
        if (!user) {
            showGuestProfile();
            return;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await showUserProfile(user);
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –≥–æ—Å—Ç–µ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
    function showGuestProfile() {
        console.log('üë§ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–æ—Å—Ç–µ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä
        const profileInitials = document.getElementById('profileInitials');
        const profilePhoto = document.getElementById('profilePhoto');
        const userFullName = document.getElementById('userFullName');
        const userUsername = document.getElementById('userUsername');
        const dataBadge = document.getElementById('dataBadge');
        const userStats = document.getElementById('userStats');
        const telegramInfo = document.getElementById('telegramInfo');
        const profileInfo = document.getElementById('profileInfo');
        
        // –ê–≤–∞—Ç–∞—Ä
        if (profileInitials) {
            profileInitials.textContent = '?';
            profileInitials.style.display = 'flex';
        }
        if (profilePhoto) {
            profilePhoto.style.display = 'none';
        }
        
        // –ò–º—è –∏ username
        if (userFullName) userFullName.textContent = '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
        if (userUsername) userUsername.textContent = '–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram';
        
        // –°–∫—Ä—ã–≤–∞–µ–º –ª–∏—à–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        if (dataBadge) dataBadge.style.display = 'none';
        if (userStats) userStats.style.display = 'none';
        if (telegramInfo) telegramInfo.style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        if (profileInfo) {
            profileInfo.innerHTML = `
                <div class="info-card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                    <div class="info-label" style="justify-content: center;">
                        <span class="icon">üîí</span>
                        –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
                    </div>
                    <div class="info-value" style="margin: 20px 0;">
                        –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram
                    </div>
                    <div style="color: #666; font-size: 0.9rem; margin-top: 15px;">
                        –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    </div>
                </div>
            `;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
        setupProfileButtons();
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async function showUserProfile(user) {
        console.log(`üë§ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${user.first_name}`);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä
        updateProfileAvatar(user);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        updateBasicInfo(user);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–æ—Ñ–∏–ª—è —Å ID, Premium –∏ —è–∑—ã–∫–æ–º
        updateProfileInfo(user);
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –±–µ–π–¥–∂
        updateProfileBadge(user);
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏
        setupProfileButtons();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏–∏
        document.getElementById('userStats').style.display = 'block';
        document.getElementById('telegramInfo').style.display = 'block';
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –∞–≤–∞—Ç–∞—Ä –ø—Ä–æ—Ñ–∏–ª—è
    function updateProfileAvatar(user) {
        const profileInitials = document.getElementById('profileInitials');
        const profilePhoto = document.getElementById('profilePhoto');
        
        if (!profileInitials) return;
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã
        const initials = getInitials(user.first_name, user.last_name);
        profileInitials.textContent = initials;
        profileInitials.style.display = 'flex';
        
        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ –µ—Å–ª–∏ –µ—Å—Ç—å
        if (user.photo_url && user.photo_url.trim() !== '') {
            console.log(`üì∏ –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ: ${user.photo_url}`);
            
            // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            const testImage = new Image();
            testImage.onload = function() {
                console.log('‚úÖ –§–æ—Ç–æ –¥–æ—Å—Ç—É–ø–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º');
                profilePhoto.src = user.photo_url;
                profilePhoto.style.display = 'block';
                profilePhoto.classList.add('loaded');
                profileInitials.style.display = 'none';
            };
            
            testImage.onerror = function() {
                console.log('‚ùå –§–æ—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã');
                profilePhoto.style.display = 'none';
                profileInitials.style.display = 'flex';
            };
            
            testImage.src = user.photo_url;
        } else {
            profilePhoto.style.display = 'none';
            profileInitials.style.display = 'flex';
        }
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    function updateBasicInfo(user) {
        const userFullName = document.getElementById('userFullName');
        const userUsername = document.getElementById('userUsername');
        
        if (userFullName) {
            userFullName.textContent = `${user.first_name || ''} ${user.last_name || ''}`.trim();
        }
        
        if (userUsername) {
            userUsername.textContent = user.username ? `@${user.username}` : '–ë–µ–∑ username';
        }
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–æ—Ñ–∏–ª—è (ID, Premium, —è–∑—ã–∫ –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ)
    function updateProfileInfo(user) {
        const profileInfo = document.getElementById('profileInfo');
        if (!profileInfo) return;
        
        profileInfo.innerHTML = '';
        
        // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è - ID, Premium, –Ø–∑—ã–∫ –≤—Å–µ–≥–¥–∞ –Ω–∞–≤–µ—Ä—Ö—É
        const primaryInfoCards = [
            {
                label: 'Telegram ID',
                value: user.id,
                icon: 'üÜî',
                copyable: true,
                description: '–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä'
            },
            {
                label: 'Premium —Å—Ç–∞—Ç—É—Å',
                value: user.is_premium ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ù–µ –∞–∫—Ç–∏–≤–µ–Ω',
                icon: '‚≠ê',
                specialClass: user.is_premium ? 'premium' : 'regular',
                description: user.is_premium ? '–ü—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞' : '–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è'
            },
            {
                label: '–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞',
                value: getLanguageName(user.language_code),
                icon: 'üåê',
                description: user.language_code ? `–ö–æ–¥: ${user.language_code.toUpperCase()}` : '–ù–µ —É–∫–∞–∑–∞–Ω'
            }
        ];
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        const secondaryInfoCards = [
            {
                label: '–ò–º—è',
                value: user.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                icon: 'üë§'
            },
            {
                label: '–§–∞–º–∏–ª–∏—è',
                value: user.last_name || '–ù–µ —É–∫–∞–∑–∞–Ω–∞',
                icon: 'üë•'
            },
            {
                label: 'Username',
                value: user.username ? `@${user.username}` : '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω',
                icon: 'üìõ',
                copyable: !!user.username
            },
            {
                label: '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏',
                value: user.firstSeen ? new Date(user.firstSeen).toLocaleDateString('ru-RU') : '–°–µ–≥–æ–¥–Ω—è',
                icon: 'üìÖ'
            },
            {
                label: '–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥',
                value: user.lastSeen ? new Date(user.lastSeen).toLocaleString('ru-RU') : '–°–µ–π—á–∞—Å',
                icon: 'üïí'
            },
            {
                label: '–°—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞',
                value: user.is_demo ? '–î–µ–º–æ-—Ä–µ–∂–∏–º' : '–†–µ–∞–ª—å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç',
                icon: 'üîê',
                specialClass: user.is_demo ? 'demo' : 'active'
            }
        ];
        
        // –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        const primarySection = document.createElement('div');
        primarySection.className = 'info-section';
        primarySection.innerHTML = `
            <h3 style="color: #fff; margin: 25px 0 15px 0; padding-bottom: 10px; border-bottom: 2px solid #4ecdc4;">
                üìä –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            </h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
        `;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        primaryInfoCards.forEach(card => {
            primarySection.innerHTML += createInfoCardHTML(card);
        });
        
        primarySection.innerHTML += `</div>`;
        profileInfo.appendChild(primarySection);
        
        // –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        const secondarySection = document.createElement('div');
        secondarySection.className = 'info-section';
        secondarySection.innerHTML = `
            <h3 style="color: #fff; margin: 30px 0 15px 0; padding-bottom: 10px; border-bottom: 2px solid #4ecdc4;">
                üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            </h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
        `;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        secondaryInfoCards.forEach(card => {
            secondarySection.innerHTML += createInfoCardHTML(card);
        });
        
        secondarySection.innerHTML += `</div>`;
        profileInfo.appendChild(secondarySection);
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è HTML –∫–∞—Ä—Ç–æ—á–∫–∏
    function createInfoCardHTML(card) {
        let valueHtml = `
            <div class="info-value ${card.specialClass || ''}">
                ${card.value}
            </div>
        `;
        
        if (card.copyable) {
            valueHtml = `
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <div class="info-value ${card.specialClass || ''}">${card.value}</div>
                    <button class="copy-button" 
                            onclick="copyToClipboard('${card.value.replace("'", "\\'").replace('@', '')}')"
                            title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å"
                            style="background: none; border: none; color: #4ecdc4; cursor: pointer; padding: 5px; font-size: 1.2rem;">
                        <i class="far fa-copy"></i>
                    </button>
                </div>
            `;
        }
        
        return `
            <div class="info-card">
                <div class="info-label">
                    <span class="icon">${card.icon}</span>
                    ${card.label}
                </div>
                ${valueHtml}
                ${card.description ? `<div style="font-size: 0.8rem; color: #666; margin-top: 5px;">${card.description}</div>` : ''}
            </div>
        `;
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é Telegram
    function updateTelegramInfo(user) {
        const telegramInfo = document.getElementById('telegramInfo');
        if (!telegramInfo) return;
        
        const telegramGrid = telegramInfo.querySelector('.telegram-info-grid');
        if (!telegramGrid) return;
        
        telegramGrid.innerHTML = '';
        
        const telegramCards = [
            {
                label: 'Telegram ID',
                value: user.id,
                icon: 'ü§ñ',
                copyable: true,
                description: '–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –≤ Telegram'
            },
            {
                label: 'Premium —Å—Ç–∞—Ç—É—Å',
                value: user.is_premium ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ù–µ –∞–∫—Ç–∏–≤–µ–Ω',
                icon: '‚≠ê',
                specialClass: user.is_premium ? 'premium' : 'regular',
                description: user.is_premium ? '–ò–º–µ–µ—Ç –ø—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫—É' : '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç'
            },
            {
                label: '–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞',
                value: getLanguageName(user.language_code),
                icon: 'üåê',
                description: user.language_code ? `–ö–æ–¥: ${user.language_code.toUpperCase()}` : '–ù–µ —É–∫–∞–∑–∞–Ω'
            },
            {
                label: '–î–æ—Å—Ç—É–ø –∫ –õ–°',
                value: user.allows_write_to_pm ? '‚úÖ –†–∞–∑—Ä–µ—à—ë–Ω' : '‚ùå –ó–∞–ø—Ä–µ—â—ë–Ω',
                icon: 'üí¨',
                specialClass: user.allows_write_to_pm ? 'online' : 'offline'
            },
            {
                label: '–¢–∏–ø —á–∞—Ç–∞',
                value: user.chat_type ? formatChatType(user.chat_type) : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                icon: 'üí≠'
            },
            {
                label: '–î–∞—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏',
                value: user.auth_date ? new Date(user.auth_date).toLocaleString('ru-RU') : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                icon: 'üì±'
            }
        ];
        
        telegramCards.forEach(card => {
            telegramGrid.innerHTML += createInfoCardHTML(card);
        });
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –±–µ–π–¥–∂ –ø—Ä–æ—Ñ–∏–ª—è
    function updateProfileBadge(user) {
        const dataBadge = document.getElementById('dataBadge');
        const badgeText = document.getElementById('badgeText');
        
        if (dataBadge && badgeText) {
            dataBadge.style.display = 'block';
            
            if (user.is_demo) {
                dataBadge.className = 'status-badge badge-demo';
                badgeText.textContent = '–î–ï–ú–û –†–ï–ñ–ò–ú';
            } else {
                dataBadge.className = 'status-badge badge-telegram';
                badgeText.textContent = user.is_premium ? 'TELEGRAM PREMIUM' : 'TELEGRAM –ê–ö–ö–ê–£–ù–¢';
            }
        }
    }

    // –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
    function setupProfileButtons() {
        const refreshButton = document.getElementById('refreshProfileButton');
        const logoutButton = document.getElementById('logoutButton');
        
        if (refreshButton) {
            refreshButton.onclick = async function() {
                showStatus('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è...', 'info');
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –∏ –æ–±—Ä–∞—Ç–Ω–æ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                const profileTab = document.getElementById('profileTab');
                const navProfile = document.getElementById('navProfile');
                
                if (profileTab.classList.contains('active')) {
                    // –ï—Å–ª–∏ —É–∂–µ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –ø—Ä–æ—Ñ–∏–ª—è, –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    await updateProfileTab();
                    showStatus('‚úÖ –ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª—ë–Ω', 'success');
                } else {
                    // –ï—Å–ª–∏ –Ω–µ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –ø—Ä–æ—Ñ–∏–ª—è, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –Ω–µ—ë
                    if (navProfile) {
                        navProfile.click();
                        setTimeout(() => {
                            showStatus('‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å', 'success');
                        }, 300);
                    }
                }
            };
        }
        
        if (logoutButton) {
            logoutButton.onclick = logout;
        }
    }

    // ===================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====================

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —è–∑—ã–∫–∞ –ø–æ –∫–æ–¥—É
    function getLanguageName(languageCode) {
        if (!languageCode) return '–ù–µ —É–∫–∞–∑–∞–Ω';
        
        const languages = {
            'ru': '–†—É—Å—Å–∫–∏–π üá∑üá∫',
            'en': '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π üá∫üá∏',
            'es': '–ò—Å–ø–∞–Ω—Å–∫–∏–π üá™üá∏',
            'fr': '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π üá´üá∑',
            'de': '–ù–µ–º–µ—Ü–∫–∏–π üá©üá™',
            'it': '–ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π üáÆüáπ',
            'pt': '–ü–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π üáµüáπ',
            'ar': '–ê—Ä–∞–±—Å–∫–∏–π üá∏üá¶',
            'zh': '–ö–∏—Ç–∞–π—Å–∫–∏–π üá®üá≥',
            'ja': '–Ø–ø–æ–Ω—Å–∫–∏–π üáØüáµ',
            'ko': '–ö–æ—Ä–µ–π—Å–∫–∏–π üá∞üá∑',
            'tr': '–¢—É—Ä–µ—Ü–∫–∏–π üáπüá∑',
            'uk': '–£–∫—Ä–∞–∏–Ω—Å–∫–∏–π üá∫üá¶',
            'be': '–ë–µ–ª–æ—Ä—É—Å—Å–∫–∏–π üáßüáæ',
            'kk': '–ö–∞–∑–∞—Ö—Å–∫–∏–π üá∞üáø'
        };
        
        return languages[languageCode.toLowerCase()] || `${languageCode.toUpperCase()} (${languageCode})`;
    }

    function formatChatType(chatType) {
        const types = {
            'private': '–õ–∏—á–Ω—ã–π —á–∞—Ç',
            'group': '–ì—Ä—É–ø–ø–∞',
            'supergroup': '–°—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞',
            'channel': '–ö–∞–Ω–∞–ª'
        };
        return types[chatType] || chatType;
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            showStatus('üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
        }).catch(err => {
            console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
            showStatus('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
        });
    }

    function getInitials(firstName, lastName) {
        if (!firstName && !lastName) return '??';
        const first = firstName ? firstName.charAt(0).toUpperCase() : '';
        const last = lastName ? lastName.charAt(0).toUpperCase() : '';
        return (first + last) || 'U';
    }

    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫
    document.addEventListener('DOMContentLoaded', () => {
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
        document.querySelectorAll('.nav-button').forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ø—Ä–æ—Ñ–∏–ª—è
                if (tabId === 'profileTab') {
                    // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
                    setTimeout(() => {
                        updateProfileTab();
                    }, 100);
                }
            });
        });
        
        console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã');
    });
    
    function getInitials(firstName, lastName) {
        if (!firstName && !lastName) return '??';
        const first = firstName ? firstName.charAt(0).toUpperCase() : '';
        const last = lastName ? lastName.charAt(0).toUpperCase() : '';
        return (first + last) || 'U';
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
    function forceShowActiveTab() {
        const activeTab = document.querySelector('.tab-content.active');
        const allTabs = document.querySelectorAll('.tab-content');
        
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤–∫–ª–∞–¥–æ–∫:');
        
        allTabs.forEach(tab => {
            const tabId = tab.id;
            const isActive = tab.classList.contains('active');
            console.log(`  ${tabId}: ${isActive ? '–∞–∫—Ç–∏–≤–Ω–∞' : '–Ω–µ –∞–∫—Ç–∏–≤–Ω–∞'}, display: ${tab.style.display}`);
            
            if (isActive) {
                tab.style.display = 'block';
                tab.style.opacity = '1';
                tab.style.visibility = 'visible';
            } else {
                tab.style.display = 'none';
            }
        });
        
        if (activeTab) {
            console.log(`‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞: ${activeTab.id}`);
        }
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    function setupNavigation() {
        const navButtons = document.querySelectorAll('.nav-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        console.log('üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏...');
        console.log('  –ö–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:', navButtons.length);
        console.log('  –í–∫–ª–∞–¥–æ–∫:', tabContents.length);
        
        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.getAttribute('data-tab');
                const targetTab = document.getElementById(tabId);
                
                console.log(`üì± –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏: ${tabId}`);
                console.log(`  –¶–µ–ª–µ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞:`, targetTab ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                
                if (!targetTab) {
                    console.error(`‚ùå –í–∫–ª–∞–¥–∫–∞ ${tabId} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!`);
                    return;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                navButtons.forEach(btn => {
                    btn.classList.remove('active');
                    btn.setAttribute('aria-selected', 'false');
                });
                
                tabContents.forEach(tab => {
                    tab.classList.remove('active');
                    tab.style.display = 'none';
                });
                
                button.classList.add('active');
                button.setAttribute('aria-selected', 'true');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                targetTab.classList.add('active');
                targetTab.style.display = 'block';
                
                console.log(`‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ –≤–∫–ª–∞–¥–∫—É: ${tabId}`);
                
                // –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
                if (tabId === 'profileTab') {
                    console.log('üîÑ –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è...');
                    setTimeout(() => {
                        updateProfileTab();
                    }, 100);
                }
                
                // –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é –æ–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–µ—Å–æ
                if (tabId === 'homeTab' && window.fortuneWheel) {
                    setTimeout(() => {
                        window.fortuneWheel.loadGameState();
                    }, 100);
                }
            });
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        const activeTab = document.querySelector('.tab-content.active');
        if (activeTab) {
            activeTab.style.display = 'block';
        }
    }
    
    // –í—ã–π—Ç–∏
    function logout() {
        console.log('üö™ –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞...');
        
        currentUser = null;
        window.currentUser = null;
        
        if (dataBadge) {
            dataBadge.className = 'status-badge badge-demo';
            badgeText.textContent = '–î–ï–ú–û –†–ï–ñ–ò–ú';
        }
        
        updateProfileTab();
        updateAuthIndicator();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–µ—Å–æ
        if (window.fortuneWheel) {
            window.fortuneWheel.updateButtons();
            window.fortuneWheel.loadGameState();
        }
        
        showStatus('‚úÖ –í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞', 'success');
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        const homeButton = document.getElementById('navHome');
        if (homeButton) homeButton.click();
        
        // –¢—Ä–∏–≥–≥–µ—Ä–∏–º —Å–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        window.dispatchEvent(new CustomEvent('userChanged'));
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', () => {
        console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        initTelegram();

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        setupNavigation();

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        setTimeout(() => {
            forceShowActiveTab();
        }, 500);

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ —É—á–∞—Å—Ç–∏—è
        setupJoinButton();

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
        updateCompactProfile();
        setupCompactProfileToggle();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è
        updateProfileTab();

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è
        setupProfileButtons();

        // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM:');
        console.log('  homeTab:', document.getElementById('homeTab') ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        console.log('  profileTab:', document.getElementById('profileTab') ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        console.log('  navHome:', document.getElementById('navHome') ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        console.log('  navProfile:', document.getElementById('navProfile') ? '–Ω–∞–π–¥–µ–Ω–∞' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–∞');

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã
        setTimeout(() => {
            if (window.fortuneWheel) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
                setInterval(() => {
                    window.fortuneWheel.loadGameState();
                }, 3000);
            }
        }, 2000);

        console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
    });

    // –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–Ω–µ—Ü —Å–∫—Ä–∏–ø—Ç–∞ –≤ index.html:

// –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
// –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
function updateCompactProfile() {
    const user = window.currentUser;
    const compactProfile = document.getElementById('compactProfile');
    const compactAvatar = document.getElementById('compactAvatar');
    const compactPhoto = document.getElementById('compactPhoto');
    const compactInitials = document.getElementById('compactInitials');
    const compactName = document.getElementById('compactName');
    const compactStatus = document.getElementById('compactStatus');
    
    if (!compactProfile || !compactName) return;
    
    if (user) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä
        if (user.photo_url) {
            compactPhoto.src = user.photo_url;
            compactPhoto.style.display = 'block';
            compactInitials.style.display = 'none';
        } else {
            const initials = getInitials(user.first_name, user.last_name);
            compactInitials.textContent = initials;
            compactInitials.style.display = 'flex';
            compactPhoto.style.display = 'none';
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∏ —Å—Ç–∞—Ç—É—Å
        compactName.textContent = `${user.first_name} ${user.last_name || ''}`.trim();
        
        // –°—Ç–∞—Ç—É—Å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ Premium
        if (user.is_premium) {
            compactStatus.innerHTML = `<span style="color: gold;">‚≠ê Premium</span> | @${user.username || '–±–µ–∑ username'}`;
            compactStatus.style.color = '#4ecdc4';
        } else {
            compactStatus.textContent = user.username ? `@${user.username}` : '–ë–µ–∑ username';
            compactStatus.style.color = '#666';
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä Premium –≤ –∞–≤–∞—Ç–∞—Ä
        if (user.is_premium) {
            compactAvatar.style.borderColor = 'gold';
            compactAvatar.style.boxShadow = '0 0 10px rgba(255, 215, 0, 0.5)';
        } else {
            compactAvatar.style.borderColor = '#4ecdc4';
            compactAvatar.style.boxShadow = 'none';
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å
        compactProfile.style.display = 'flex';
    } else {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º
        compactInitials.textContent = '?';
        compactInitials.style.display = 'flex';
        compactPhoto.style.display = 'none';
        compactName.textContent = '–ì–æ—Å—Ç—å';
        compactStatus.textContent = '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
        compactStatus.style.color = '#ff6b6b';
        compactAvatar.style.borderColor = '#333';
        compactAvatar.style.boxShadow = 'none';
    }
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ—Ñ–∏–ª—è
function setupCompactProfileToggle() {
    const compactToggle = document.getElementById('compactToggle');
    const compactInfo = document.getElementById('compactInfo');
    
    if (compactToggle && compactInfo) {
        let isExpanded = true;
        
        compactToggle.addEventListener('click', () => {
            isExpanded = !isExpanded;
            
            if (isExpanded) {
                compactInfo.style.display = 'block';
                compactToggle.innerHTML = '<i class="fas fa-chevron-down" aria-hidden="true"></i>';
                compactToggle.setAttribute('aria-label', '–°–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                compactToggle.setAttribute('aria-expanded', 'true');
            } else {
                compactInfo.style.display = 'none';
                compactToggle.innerHTML = '<i class="fas fa-chevron-up" aria-hidden="true"></i>';
                compactToggle.setAttribute('aria-label', '–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                compactToggle.setAttribute('aria-expanded', 'false');
            }
        });
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - –¥–æ–±–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤—ã:
document.addEventListener('DOMContentLoaded', () => {
    console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
    
    initTelegram();
    setupNavigation();
    setupJoinButton();
    
    // –ù–æ–≤—ã–µ –≤—ã–∑–æ–≤—ã
    updateCompactProfile();
    setupCompactProfileToggle();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    window.addEventListener('userChanged', () => {
        updateCompactProfile();
    });
    
    if (!isTelegramApp) {
        console.log('‚ö†Ô∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤–Ω–µ Telegram');
        showStatus('‚ö†Ô∏è –û—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏', 'error');
    }
    
    window.addEventListener('userChanged', () => {
        console.log('üîÑ –°–æ–±—ã—Ç–∏–µ userChanged, –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å...');
        updateProfileTab();
        updateCompactProfile();
    });
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É
    document.addEventListener('visibilitychange', () => {
        if (!document.hidden && document.getElementById('profileTab')?.classList.contains('active')) {
            console.log('üîÑ –í–∏–¥–∏–º–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞, –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å...');
            setTimeout(() => {
                updateProfileTab();
            }, 500);
        }
    });
});

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
function startGameAutoRefresh() {
    if (window.fortuneWheel) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
        setInterval(() => {
            window.fortuneWheel.loadGameState();
        }, 2000);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden) {
                window.fortuneWheel.loadGameState();
            }
        });
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–≤–µ–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞
function createStarDecoration() {
    const starsContainer = document.getElementById('starsContainer');
    if (!starsContainer) return;
    
    starsContainer.innerHTML = '';
    
    // –°–æ–∑–¥–∞–µ–º 15 –∑–≤–µ–∑–¥
    for (let i = 0; i < 15; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        
        // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
        const left = Math.random() * 100;
        const top = Math.random() * 100;
        
        // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
        const delay = Math.random() * 5;
        const duration = 3 + Math.random() * 4;
        
        star.style.left = `${left}%`;
        star.style.top = `${top}%`;
        star.style.animationDelay = `${delay}s`;
        star.style.animationDuration = `${duration}s`;
        star.innerHTML = '‚òÖ';
        
        starsContainer.appendChild(star);
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π –∑–∞–≥–æ–ª–æ–≤–∫–∞
function setupTitleEffects() {
    const title = document.getElementById('stacksTitle');
    if (!title) return;
    
    // –í–∞—Ä–∏–∞–Ω—Ç—ã —Å—Ç–∏–ª–µ–π
    const styles = ['white', 'colorful', 'outlined', 'neon', 'gold'];
    let currentStyle = 0;
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∏–ª—è –ø–æ –∫–ª–∏–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    title.addEventListener('click', function() {
        // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Å—Ç–∏–ª–µ–π
        styles.forEach(style => {
            title.classList.remove(style);
        });
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Å—Ç–∏–ª—å
        currentStyle = (currentStyle + 1) % styles.length;
        title.classList.add(styles[currentStyle]);
        
        console.log(`üé® –°—Ç–∏–ª—å –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${styles[currentStyle]}`);
    });
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–º–µ–Ω–∞ —Å—Ç–∏–ª–µ–π –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
    setInterval(() => {
        // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Å—Ç–∏–ª–µ–π
        styles.forEach(style => {
            title.classList.remove(style);
        });
        
        // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Å—Ç–∏–ª—å (–∫—Ä–æ–º–µ —Ç–µ–∫—É—â–µ–≥–æ)
        let newStyle;
        do {
            newStyle = Math.floor(Math.random() * styles.length);
        } while (newStyle === currentStyle);
        
        currentStyle = newStyle;
        title.classList.add(styles[currentStyle]);
    }, 10000);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
document.addEventListener('DOMContentLoaded', () => {
    // –°–æ–∑–¥–∞–µ–º –∑–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω
    createStarDecoration();
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –∑–∞–≥–æ–ª–æ–≤–∫–∞
    setupTitleEffects();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–≤–µ–∑–¥—ã –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    setInterval(createStarDecoration, 30000);
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', () => {
    console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
    
    initTelegram();
    setupNavigation();
    setupJoinButton();
    updateCompactProfile();
    setupCompactProfileToggle();
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–ª–µ—Å–∞
    setTimeout(() => {
        startGameAutoRefresh();
    }, 3000);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
    if (!isTelegramApp) {
        showStatus('–î–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞', 'info');
    } else {
        showStatus('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!', 'success');
    }
    
    console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
});

// ===================== –ó–í–ï–ó–î–ù–û–ï –ü–û–õ–ï =====================

class Starfield {
    constructor() {
        this.container = document.getElementById('starfield');
        this.stars = [];
        this.shootingStars = [];
        this.nebulas = [];
        this.galaxy = null;
        this.animationId = null;
        this.lastTime = 0;
        
        this.init();
    }
    
    init() {
        if (!this.container) {
            console.error('Starfield container not found');
            return;
        }
        
        // –°–æ–∑–¥–∞–µ–º —Å–ª–æ–∏ –¥–ª—è –ø–∞—Ä–∞–ª–ª–∞–∫—Å–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞
        this.createLayers();
        
        // –°–æ–∑–¥–∞–µ–º –∑–≤–µ–∑–¥—ã
        this.createStars();
        
        // –°–æ–∑–¥–∞–µ–º —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–∏
        this.createNebulas();
        
        // –°–æ–∑–¥–∞–µ–º –≥–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Å–ø–∏—Ä–∞–ª—å
        this.createGalaxy();
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
        this.startAnimation();
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–¥–∞—é—â–∏—Ö –∑–≤–µ–∑–¥
        this.startShootingStars();
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', () => this.handleResize());
        
        console.log('‚≠ê Starfield initialized with', this.stars.length, 'stars');
    }
    
    createLayers() {
        // –°–æ–∑–¥–∞–µ–º 3 —Å–ª–æ—è –¥–ª—è –ø–∞—Ä–∞–ª–ª–∞–∫—Å–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞
        for (let i = 1; i <= 3; i++) {
            const layer = document.createElement('div');
            layer.className = `starfield-layer layer-${i}`;
            layer.dataset.speed = i * 0.2; // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Å–ª–æ—è
            this.container.appendChild(layer);
        }
    }
    
    createStars() {
        const layers = this.container.querySelectorAll('.starfield-layer');
        const starCount = window.innerWidth < 480 ? 200 : 400; // –ú–µ–Ω—å—à–µ –∑–≤–µ–∑–¥ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
        
        const starColors = ['', 'blue', 'pink', 'purple', 'gold', 'cyan'];
        const starSizes = ['small', 'medium', 'large'];
        
        layers.forEach((layer, layerIndex) => {
            const starsPerLayer = Math.floor(starCount / layers.length);
            
            for (let i = 0; i < starsPerLayer; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
                const size = starSizes[Math.floor(Math.random() * starSizes.length)];
                star.classList.add(size);
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç (30% —Ü–≤–µ—Ç–Ω—ã—Ö –∑–≤–µ–∑–¥)
                if (Math.random() > 0.7) {
                    const color = starColors[Math.floor(Math.random() * starColors.length)];
                    if (color) star.classList.add(color);
                }
                
                // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                
                star.style.left = `${x}%`;
                star.style.top = `${y}%`;
                
                // –°–ª—É—á–∞–π–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è
                const delay = Math.random() * 5;
                const duration = 2 + Math.random() * 3;
                
                star.style.animationDelay = `${delay}s`;
                star.style.animationDuration = `${duration}s`;
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –¥–ª—è –ø–∞—Ä–∞–ª–ª–∞–∫—Å–∞
                const moveX = (Math.random() - 0.5) * 200 * (layerIndex + 1);
                const moveY = (Math.random() - 0.5) * 100 * (layerIndex + 1);
                
                star.style.setProperty('--move-x', `${moveX}px`);
                star.style.setProperty('--move-y', `${moveY}px`);
                star.style.animation = `moveStar ${20 + layerIndex * 10}s linear infinite alternate, twinkle${size.charAt(0).toUpperCase() + size.slice(1)} ${duration}s ease-in-out ${delay}s infinite`;
                
                layer.appendChild(star);
                this.stars.push({
                    element: star,
                    layer: layerIndex,
                    x, y,
                    moveX, moveY
                });
            }
        });
    }
    
    createNebulas() {
        // –°–æ–∑–¥–∞–µ–º 3-5 —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–µ–π
        const nebulaCount = 3 + Math.floor(Math.random() * 3);
        const nebulaColors = ['blue', 'purple', 'pink'];
        
        for (let i = 0; i < nebulaCount; i++) {
            const nebula = document.createElement('div');
            nebula.className = 'nebula';
            
            const color = nebulaColors[Math.floor(Math.random() * nebulaColors.length)];
            nebula.classList.add(color);
            
            // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –∏ —Ä–∞–∑–º–µ—Ä
            const x = Math.random() * 100;
            const y = Math.random() * 100;
            const size = 200 + Math.random() * 300;
            
            nebula.style.left = `${x}%`;
            nebula.style.top = `${y}%`;
            nebula.style.width = `${size}px`;
            nebula.style.height = `${size}px`;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
            const duration = 40 + Math.random() * 40;
            nebula.style.animation = `moveStar ${duration}s linear infinite alternate`;
            nebula.style.setProperty('--move-x', `${(Math.random() - 0.5) * 400}px`);
            nebula.style.setProperty('--move-y', `${(Math.random() - 0.5) * 200}px`);
            
            this.container.appendChild(nebula);
            this.nebulas.push(nebula);
        }
    }
    
    createGalaxy() {
        const galaxy = document.createElement('div');
        galaxy.className = 'galaxy-spiral';
        
        // –¶–µ–Ω—Ç—Ä –≥–∞–ª–∞–∫—Ç–∏–∫–∏
        galaxy.style.left = '50%';
        galaxy.style.top = '50%';
        galaxy.style.transform = 'translate(-50%, -50%)';
        
        this.container.appendChild(galaxy);
        this.galaxy = galaxy;
    }
    
    startShootingStars() {
        // –°–æ–∑–¥–∞–µ–º –ø–∞–¥–∞—é—â–∏–µ –∑–≤–µ–∑–¥—ã –∫–∞–∂–¥—ã–µ 3-8 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            if (Math.random() > 0.3) { // 70% —à–∞–Ω—Å —Å–æ–∑–¥–∞—Ç—å –ø–∞–¥–∞—é—â—É—é –∑–≤–µ–∑–¥—É
                this.createShootingStar();
            }
        }, 3000);
    }
    
    createShootingStar() {
        const shootingStar = document.createElement('div');
        shootingStar.className = 'shooting-star';
        
        // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (—Å–ª—É—á–∞–π–Ω–æ —Å –∫—Ä–∞—è —ç–∫—Ä–∞–Ω–∞)
        const startX = Math.random() * 100;
        const startY = Math.random() * 30; // –¢–æ–ª—å–∫–æ –≤–µ—Ä—Ö–Ω—è—è —Ç—Ä–µ—Ç—å —ç–∫—Ä–∞–Ω–∞
        
        shootingStar.style.left = `${startX}%`;
        shootingStar.style.top = `${startY}%`;
        
        // –°–ª—É—á–∞–π–Ω—ã–π —É–≥–æ–ª
        const angle = (Math.random() * 30 + 15) * (Math.PI / 180); // 15-45 –≥—Ä–∞–¥—É—Å–æ–≤
        const length = 100 + Math.random() * 200;
        
        // –¶–≤–µ—Ç (—á–∞—â–µ –±–µ–ª—ã–π, –∏–Ω–æ–≥–¥–∞ —Ü–≤–µ—Ç–Ω–æ–π)
        if (Math.random() > 0.8) {
            const colors = ['#4ecdc4', '#ff6b6b', '#a29bfe'];
            shootingStar.style.background = `linear-gradient(90deg, transparent, ${colors[Math.floor(Math.random() * colors.length)]}, transparent)`;
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª–µ—Ç–∞
        const animation = shootingStar.animate([
            {
                transform: `rotate(${angle}rad) scaleX(0)`,
                opacity: 0
            },
            {
                transform: `rotate(${angle}rad) scaleX(1)`,
                opacity: 1,
                offset: 0.1
            },
            {
                transform: `rotate(${angle}rad) scaleX(1) translateX(${length}px)`,
                opacity: 1,
                offset: 0.8
            },
            {
                transform: `rotate(${angle}rad) scaleX(0) translateX(${length}px)`,
                opacity: 0
            }
        ], {
            duration: 1500 + Math.random() * 1000,
            easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
        });
        
        animation.onfinish = () => {
            shootingStar.remove();
            this.shootingStars = this.shootingStars.filter(s => s !== shootingStar);
        };
        
        this.container.appendChild(shootingStar);
        this.shootingStars.push(shootingStar);
    }
    
    startAnimation() {
        const animate = (time) => {
            if (!this.lastTime) this.lastTime = time;
            const delta = time - this.lastTime;
            this.lastTime = time;
            
            // –ü–∞—Ä–∞–ª–ª–∞–∫—Å –¥–≤–∏–∂–µ–Ω–∏–µ –∑–≤–µ–∑–¥
            this.stars.forEach(star => {
                const speed = parseFloat(star.element.parentElement.dataset.speed) || 0.2;
                const moveX = parseFloat(star.element.style.getPropertyValue('--move-x')) || 0;
                const moveY = parseFloat(star.element.style.getPropertyValue('--move-y')) || 0;
                
                // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –¥—Ä–µ–π—Ñ—É—é—â–µ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
                const driftX = Math.sin(time / 10000 + star.x) * 50 * speed;
                const driftY = Math.cos(time / 8000 + star.y) * 30 * speed;
                
                star.element.style.transform = `translate(${driftX}px, ${driftY}px)`;
            });
            
            // –î–≤–∏–∂–µ–Ω–∏–µ —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–µ–π
            this.nebulas.forEach(nebula => {
                const driftX = Math.sin(time / 20000) * 100;
                const driftY = Math.cos(time / 25000) * 50;
                nebula.style.transform = `translate(${driftX}px, ${driftY}px)`;
            });
            
            this.animationId = requestAnimationFrame(animate);
        };
        
        this.animationId = requestAnimationFrame(animate);
    }
    
    handleResize() {
        // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –ø–æ–∑–∏—Ü–∏–∏
        // –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å - –∑–≤–µ–∑–¥—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è
        console.log('‚≠ê Starfield resized');
    }
    
    destroy() {
        if (this.animationId) {
            cancelAnimationFrame(this.animationId);
        }
        if (this.container) {
            this.container.innerHTML = '';
        }
        this.stars = [];
        this.shootingStars = [];
        this.nebulas = [];
        console.log('‚≠ê Starfield destroyed');
    }
}

// ===================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====================

let starfieldInstance = null;

// –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–≤–µ–∑–¥–Ω–æ–≥–æ –ø–æ–ª—è
function initStarfield() {
    if (starfieldInstance) {
        starfieldInstance.destroy();
    }
    
    starfieldInstance = new Starfield();
    return starfieldInstance;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –∑–≤–µ–∑–¥
function setStarfieldIntensity(intensity = 'medium') {
    const intensities = {
        low: 100,
        medium: 400,
        high: 800,
        ultra: 1500
    };
    
    if (starfieldInstance) {
        starfieldInstance.destroy();
        
        // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —Å –Ω–æ–≤–æ–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å—é
        setTimeout(() => {
            starfieldInstance = new Starfield();
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–≤–µ–∑–¥
            console.log(`‚≠ê Starfield intensity set to: ${intensity}`);
        }, 100);
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
function enableHolidayMode() {
    if (!starfieldInstance) return;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –±–æ–ª—å—à–µ —Ü–≤–µ—Ç–Ω—ã—Ö –∑–≤–µ–∑–¥
    const allStars = document.querySelectorAll('.star');
    allStars.forEach(star => {
        if (Math.random() > 0.5) {
            const colors = ['blue', 'pink', 'purple', 'gold', 'cyan'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ü–≤–µ—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã
            colors.forEach(c => star.classList.remove(c));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ü–≤–µ—Ç
            star.classList.add(color);
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–≤–µ—á–µ–Ω–∏–µ
            star.style.boxShadow = `0 0 15px var(--${color}-rgb, currentColor), 0 0 30px var(--${color}-rgb, currentColor)`;
        }
    });
    
    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –ø–∞–¥–∞—é—â–∏—Ö –∑–≤–µ–∑–¥
    clearInterval(starfieldInstance.shootingStarInterval);
    starfieldInstance.shootingStarInterval = setInterval(() => {
        if (Math.random() > 0.2) {
            starfieldInstance.createShootingStar();
        }
    }, 1500);
    
    console.log('‚≠ê Holiday mode enabled!');
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', () => {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–≤–µ–∑–¥–Ω–æ–µ –ø–æ–ª–µ
    initStarfield();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    window.starfield = starfieldInstance;
    window.setStarfieldIntensity = setStarfieldIntensity;
    window.enableHolidayMode = enableHolidayMode;
    
    // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —Å–æ–±—ã—Ç–∏—é
    // –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–±–µ–¥–µ –≤ –∏–≥—Ä–µ
    window.addEventListener('gameWon', () => {
        enableHolidayMode();
        setTimeout(() => {
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            initStarfield();
        }, 10000);
    });
    
    console.log('‚≠ê Starfield ready!');
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ä–µ–∂–∏–º–∞ —ç–∫–æ–Ω–æ–º–∏–∏ –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏
if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    console.log('‚≠ê Reduced motion detected, simplifying starfield...');
    // –ú–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
}
</script>
</body>
</html>